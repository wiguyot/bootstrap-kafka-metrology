[agent]
  interval = "3s"
  round_interval = true
  omit_hostname = false

[[outputs.influxdb_v2]]
  urls = ["http://influxdb:8086"]
  token = "my-token"
  organization = "my-org"
  bucket = "kafka_metrics"

[[inputs.jolokia2_agent]]
  urls = ["http://kafka-1:8778/jolokia"]
  name_prefix = "kafka_"
  tags = { broker = "kafka-1" }

  [[inputs.jolokia2_agent.metric]]
    name  = "messages_in"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=MessagesInPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "bytes_in"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=BytesInPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "bytes_out"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=BytesOutPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "bytes_rejected"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=BytesRejectedPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "failed_fetch"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=FailedFetchRequestsPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "failed_produce"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=FailedProduceRequestsPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "replication_in"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=ReplicationBytesInPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "replication_out"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=ReplicationBytesOutPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "produce_requests"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=TotalProduceRequestsPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "fetch_requests"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=TotalFetchRequestsPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "handler_idle"
    mbean = "kafka.server:type=KafkaRequestHandlerPool,name=RequestHandlerAvgIdlePercent"
    paths = ["Value"]

  [[inputs.jolokia2_agent.metric]]
    name  = "produce_queue_time"
    mbean = "kafka.server:type=RequestMetrics,name=ProduceRequestQueueTimeMs"
    paths = ["Count", "Mean", "Max"]

  [[inputs.jolokia2_agent.metric]]
    name  = "fetch_queue_time"
    mbean = "kafka.server:type=RequestMetrics,name=FetchRequestQueueTimeMs"
    paths = ["Count", "Mean", "Max"]

[[inputs.jolokia2_agent]]
  urls = ["http://kafka-2:8778/jolokia"]
  name_prefix = "kafka_"
  tags = { broker = "kafka-2" }

  [[inputs.jolokia2_agent.metric]]
    name  = "messages_in"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=MessagesInPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "bytes_in"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=BytesInPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "bytes_out"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=BytesOutPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "bytes_rejected"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=BytesRejectedPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "failed_fetch"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=FailedFetchRequestsPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "failed_produce"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=FailedProduceRequestsPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "replication_in"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=ReplicationBytesInPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "replication_out"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=ReplicationBytesOutPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "produce_requests"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=TotalProduceRequestsPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "fetch_requests"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=TotalFetchRequestsPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "handler_idle"
    mbean = "kafka.server:type=KafkaRequestHandlerPool,name=RequestHandlerAvgIdlePercent"
    paths = ["Value"]

  [[inputs.jolokia2_agent.metric]]
    name  = "produce_queue_time"
    mbean = "kafka.server:type=RequestMetrics,name=ProduceRequestQueueTimeMs"
    paths = ["Count", "Mean", "Max"]

  [[inputs.jolokia2_agent.metric]]
    name  = "fetch_queue_time"
    mbean = "kafka.server:type=RequestMetrics,name=FetchRequestQueueTimeMs"
    paths = ["Count", "Mean", "Max"]

[[inputs.jolokia2_agent]]
  urls = ["http://kafka-3:8778/jolokia"]
  name_prefix = "kafka_"
  tags = { broker = "kafka-3" }

  [[inputs.jolokia2_agent.metric]]
    name  = "messages_in"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=MessagesInPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "bytes_in"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=BytesInPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "bytes_out"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=BytesOutPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "bytes_rejected"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=BytesRejectedPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "failed_fetch"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=FailedFetchRequestsPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "failed_produce"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=FailedProduceRequestsPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "replication_in"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=ReplicationBytesInPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "replication_out"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=ReplicationBytesOutPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "produce_requests"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=TotalProduceRequestsPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "fetch_requests"
    mbean = "kafka.server:type=BrokerTopicMetrics,name=TotalFetchRequestsPerSec"
    paths = ["Count"]

  [[inputs.jolokia2_agent.metric]]
    name  = "handler_idle"
    mbean = "kafka.server:type=KafkaRequestHandlerPool,name=RequestHandlerAvgIdlePercent"
    paths = ["Value"]

  [[inputs.jolokia2_agent.metric]]
    name  = "produce_queue_time"
    mbean = "kafka.server:type=RequestMetrics,name=ProduceRequestQueueTimeMs"
    paths = ["Count", "Mean", "Max"]

  [[inputs.jolokia2_agent.metric]]
    name  = "fetch_queue_time"
    mbean = "kafka.server:type=RequestMetrics,name=FetchRequestQueueTimeMs"
    paths = ["Count", "Mean", "Max"]


